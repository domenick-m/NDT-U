2022-08-08 10:34:15,204 INFO    Thread-8  :318853 [wandb_setup.py:_flush():75] Loading settings from /home/dmifsud/.config/wandb/settings
2022-08-08 10:34:15,204 INFO    Thread-8  :318853 [wandb_setup.py:_flush():75] Loading settings from wandb/settings
2022-08-08 10:34:15,204 INFO    Thread-8  :318853 [wandb_setup.py:_flush():75] Loading settings from environment variables: {'silent': 'true', 'root_dir': '/home/dmifsud/Projects/NDT-U', 'project': 'no-val-dropout-test', 'run_id': '706vyftc', 'sweep_param_path': '/home/dmifsud/Projects/NDT-U/wandb/sweep-6n5o9sn6/config-706vyftc.yaml', 'sweep_id': '6n5o9sn6'}
2022-08-08 10:34:15,204 INFO    Thread-8  :318853 [wandb_setup.py:_flush():75] Inferring run settings from compute environment: {'program_relpath': 'train.py', 'program': 'train.py'}
2022-08-08 10:34:15,204 INFO    Thread-8  :318853 [wandb_init.py:_log_setup():405] Logging user logs to /home/dmifsud/Projects/NDT-U/wandb/run-20220808_103415-706vyftc/logs/debug.log
2022-08-08 10:34:15,205 INFO    Thread-8  :318853 [wandb_init.py:_log_setup():406] Logging internal logs to /home/dmifsud/Projects/NDT-U/wandb/run-20220808_103415-706vyftc/logs/debug-internal.log
2022-08-08 10:34:15,205 INFO    Thread-8  :318853 [wandb_init.py:init():439] calling init triggers
2022-08-08 10:34:15,205 INFO    Thread-8  :318853 [wandb_init.py:init():442] wandb.init called with sweep_config: {'setup.seed': 10}
config: {'setup': {'dataset': 'mc_maze_small', 'seed': 100, 'subset_seed': 404, 'gpu_idx': -1, 'save_model': True, 'save_min_bps': -1000.0, 'log_eps': 1e-07, 'config_dir': 'configs/', 'data_dir': 'data/', 'runs_dir': 'runs/'}, 'train': {'batch_size': 64, 'epochs': 20, 'val_interval': 10, 'val_type': 'original', 'val_ratio': 0.05, 'sweep_enabled': False, 'sweep_type': 'grid', 'sweep_epochs': 9999, 'early_stopping': True, 'es_min_bps': 0.31, 'es_chk_pnt': 0.5, 'init_lr': 0.01, 'optimizer': 'AdamW', 'scheduler': 'Cosine', 'warmup_steps': 1500, 'max_grad_norm': 200.0, 'weight_decay': 1e-07, 'mask_max_span': 6, 'ramp_start': 1000, 'ramp_end': 10000}, 'model': {'n_heads': 4, 'n_layers': 6, 'hidden_size': 256, 'dropout': 0.4, 'dropout_rates': 0.5, 'dropout_embedding': 0.7, 'dropout_attention': 0.5, 'loss_ratio': 0.25, 'mask_ratio': 0.75, 'random_ratio': 1.0, 'norm': 'scale', 'activation': 'relu', 'max_spike_count': 20, 'xavier': False, 'initrange': 0.01, 'context_forward': 35, 'context_backward': 35}, 'wandb': {'log': True, 'log_freq': 250, 'log_local': False, 'project': 'no-val-dropout-test', 'sweep_name': 'my-sweep', 'silent': 'true', 'alt_wandb_dirs': [(['rock', 'paper', 'scissors'], '/s/*/b/tmp/dmifsud/'), (['mercury', 'venus', 'earth', 'mars', 'jupiter', 'saturn', 'uranus', 'neptune'], '/s/*/a/tmp/dmifsud/')], 'sweep': {'setup': {'seed': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]}, 'train': {}, 'model': {}}}}
2022-08-08 10:34:15,205 INFO    Thread-8  :318853 [wandb_init.py:init():492] starting backend
2022-08-08 10:34:15,205 INFO    Thread-8  :318853 [backend.py:_multiprocessing_setup():99] multiprocessing start_methods=fork,spawn,forkserver, using: spawn
2022-08-08 10:34:15,208 INFO    Thread-8  :318853 [backend.py:ensure_launched():219] starting backend process...
2022-08-08 10:34:15,230 INFO    Thread-8  :318853 [backend.py:ensure_launched():224] started backend process with pid: 328258
2022-08-08 10:34:15,231 INFO    Thread-8  :318853 [wandb_init.py:init():501] backend started and connected
2022-08-08 10:34:15,233 INFO    Thread-8  :318853 [wandb_run.py:_config_callback():992] config_cb None None {'setup.seed': 10}
2022-08-08 10:34:15,236 INFO    Thread-8  :318853 [wandb_init.py:init():565] updated telemetry
2022-08-08 10:34:15,305 INFO    Thread-8  :318853 [wandb_init.py:init():596] communicating run to backend with 30 second timeout
2022-08-08 10:34:16,047 INFO    Thread-8  :318853 [wandb_run.py:_on_init():1759] communicating current version
2022-08-08 10:34:16,095 INFO    Thread-8  :318853 [wandb_run.py:_on_init():1763] got version response upgrade_message: "wandb version 0.13.1 is available!  To upgrade, please run:\n $ pip install wandb --upgrade"

2022-08-08 10:34:16,095 INFO    Thread-8  :318853 [wandb_init.py:init():625] starting run threads in backend
2022-08-08 10:34:18,189 INFO    Thread-8  :318853 [wandb_run.py:_console_start():1733] atexit reg
2022-08-08 10:34:18,189 INFO    Thread-8  :318853 [wandb_run.py:_redirect():1606] redirect: SettingsConsole.REDIRECT
2022-08-08 10:34:18,189 INFO    Thread-8  :318853 [wandb_run.py:_redirect():1611] Redirecting console.
2022-08-08 10:34:18,190 ERROR   Thread-8  :318853 [wandb_run.py:_redirect():1670] Failed to redirect.
Traceback (most recent call last):
  File "/home/dmifsud/miniconda3/envs/ndtu/lib/python3.8/site-packages/wandb/sdk/wandb_run.py", line 1663, in _redirect
    out_redir.install()
  File "/home/dmifsud/miniconda3/envs/ndtu/lib/python3.8/site-packages/wandb/sdk/lib/redirect.py", line 709, in install
    _WSCH.add_fd(self._pipe_read_fd)
  File "/home/dmifsud/miniconda3/envs/ndtu/lib/python3.8/site-packages/wandb/sdk/lib/redirect.py", line 659, in add_fd
    self._register()
  File "/home/dmifsud/miniconda3/envs/ndtu/lib/python3.8/site-packages/wandb/sdk/lib/redirect.py", line 644, in _register
    old_handler = signal.signal(signal.SIGWINCH, lambda *_: None)
  File "/home/dmifsud/miniconda3/envs/ndtu/lib/python3.8/signal.py", line 47, in signal
    handler = _signal.signal(_enum_to_int(signalnum), _enum_to_int(handler))
ValueError: signal only works in main thread
2022-08-08 10:34:18,190 INFO    Thread-8  :318853 [wandb_init.py:init():664] run started, returning control to user process
2022-08-08 10:34:18,201 INFO    Thread-8  :318853 [wandb_run.py:_config_callback():992] config_cb None None {'setup': {'dataset': 'mc_maze_small', 'seed': 100, 'subset_seed': 404, 'gpu_idx': -1, 'save_model': True, 'save_min_bps': 0.25, 'log_eps': 1e-07, 'config_dir': 'configs/', 'data_dir': 'data/', 'runs_dir': 'runs/'}, 'train': {'batch_size': 64, 'epochs': 20000, 'val_interval': 10, 'val_type': 'original', 'val_ratio': 0.05, 'sweep_enabled': True, 'sweep_type': 'grid', 'sweep_epochs': 99999999, 'early_stopping': False, 'es_min_bps': 0.125, 'es_chk_pnt': 0.5, 'init_lr': 0.005, 'optimizer': 'AdamW', 'scheduler': 'Cosine', 'warmup_steps': 1000, 'max_grad_norm': 200.0, 'weight_decay': 5e-05, 'mask_max_span': 3, 'ramp_start': 5000, 'ramp_end': 10000}, 'model': {'n_heads': 2, 'n_layers': 4, 'hidden_size': 128, 'dropout': 0.5, 'dropout_rates': 0.7, 'dropout_embedding': 0.7, 'dropout_attention': 0.5, 'loss_ratio': 0.25, 'mask_ratio': 0.75, 'random_ratio': 1.0, 'norm': 'layer', 'activation': 'relu', 'max_spike_count': 20, 'xavier': False, 'initrange': 0.01, 'context_forward': 35, 'context_backward': 35}, 'wandb': {'log': True, 'log_freq': 250, 'log_local': False, 'project': 'no-val-dropout-test', 'sweep_name': 'my-sweep', 'silent': 'true', 'alt_wandb_dirs': [], 'sweep': {'setup': {'seed': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]}, 'train': {}, 'model': {}}}}
2022-08-08 10:34:18,201 INFO    Thread-8  :318853 [wandb_config.py:__setitem__():153] config set setup = {'dataset': 'mc_maze_small', 'seed': 10, 'subset_seed': 404, 'gpu_idx': -1, 'save_model': True, 'save_min_bps': 0.25, 'log_eps': 1e-07, 'config_dir': 'configs/', 'data_dir': 'data/', 'runs_dir': 'runs/'} - None
2022-08-08 10:34:18,201 INFO    Thread-8  :318853 [wandb_config.py:__setitem__():153] config set train = {'batch_size': 64, 'epochs': 20000, 'val_interval': 10, 'val_type': 'original', 'val_ratio': 0.05, 'sweep_enabled': True, 'sweep_type': 'grid', 'sweep_epochs': 99999999, 'early_stopping': False, 'es_min_bps': 0.125, 'es_chk_pnt': 0.5, 'init_lr': 0.005, 'optimizer': 'AdamW', 'scheduler': 'Cosine', 'warmup_steps': 1000, 'max_grad_norm': 200.0, 'weight_decay': 5e-05, 'mask_max_span': 3, 'ramp_start': 5000, 'ramp_end': 10000} - None
2022-08-08 10:34:18,201 INFO    Thread-8  :318853 [wandb_config.py:__setitem__():153] config set model = {'n_heads': 2, 'n_layers': 4, 'hidden_size': 128, 'dropout': 0.5, 'dropout_rates': 0.7, 'dropout_embedding': 0.7, 'dropout_attention': 0.5, 'loss_ratio': 0.25, 'mask_ratio': 0.75, 'random_ratio': 1.0, 'norm': 'layer', 'activation': 'relu', 'max_spike_count': 20, 'xavier': False, 'initrange': 0.01, 'context_forward': 35, 'context_backward': 35} - None
2022-08-08 10:34:18,202 INFO    Thread-8  :318853 [wandb_config.py:__setitem__():153] config set wandb = {'log': True, 'log_freq': 250, 'log_local': False, 'project': 'no-val-dropout-test', 'sweep_name': 'my-sweep', 'silent': 'true', 'alt_wandb_dirs': [], 'sweep': {'setup': {'seed': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]}, 'train': {}, 'model': {}}} - None
2022-08-08 10:34:18,314 INFO    Thread-8  :318853 [wandb_watch.py:watch():47] Watching
2022-08-08 10:42:23,870 INFO    Thread-8  :318853 [wandb_run.py:finish():1539] finishing run domenick-m/no-val-dropout-test/706vyftc
2022-08-08 10:42:23,870 INFO    Thread-8  :318853 [wandb_run.py:_atexit_cleanup():1702] got exitcode: 1
2022-08-08 10:42:23,872 INFO    Thread-8  :318853 [wandb_run.py:_restore():1674] restore
2022-08-08 10:42:23,889 INFO    Thread-8  :318853 [wandb_run.py:_on_finish():1831] got exit ret: file_counts {
  wandb_count: 1
}
pusher_stats {
  uploaded_bytes: 733
  total_bytes: 733
}

2022-08-08 10:42:24,213 INFO    Thread-8  :318853 [wandb_run.py:_on_finish():1831] got exit ret: file_counts {
  wandb_count: 1
}
pusher_stats {
  uploaded_bytes: 733
  total_bytes: 733
}

2022-08-08 10:42:24,340 INFO    Thread-8  :318853 [wandb_run.py:_on_finish():1831] got exit ret: file_counts {
  wandb_count: 1
}
pusher_stats {
  uploaded_bytes: 733
  total_bytes: 733
}

2022-08-08 10:42:25,025 INFO    Thread-8  :318853 [wandb_run.py:_on_finish():1831] got exit ret: file_counts {
  wandb_count: 3
}
pusher_stats {
  uploaded_bytes: 733
  total_bytes: 107755
}

2022-08-08 10:42:25,134 INFO    Thread-8  :318853 [wandb_run.py:_on_finish():1831] got exit ret: file_counts {
  wandb_count: 5
}
pusher_stats {
  uploaded_bytes: 733
  total_bytes: 113346
}

2022-08-08 10:42:25,236 INFO    Thread-8  :318853 [wandb_run.py:_on_finish():1831] got exit ret: file_counts {
  wandb_count: 5
}
pusher_stats {
  uploaded_bytes: 113346
  total_bytes: 113346
}

2022-08-08 10:42:25,338 INFO    Thread-8  :318853 [wandb_run.py:_on_finish():1831] got exit ret: file_counts {
  wandb_count: 5
}
pusher_stats {
  uploaded_bytes: 113346
  total_bytes: 113346
}

2022-08-08 10:42:25,440 INFO    Thread-8  :318853 [wandb_run.py:_on_finish():1831] got exit ret: file_counts {
  wandb_count: 5
}
pusher_stats {
  uploaded_bytes: 113346
  total_bytes: 113346
}

2022-08-08 10:42:25,541 INFO    Thread-8  :318853 [wandb_run.py:_on_finish():1831] got exit ret: file_counts {
  wandb_count: 5
}
pusher_stats {
  uploaded_bytes: 113346
  total_bytes: 113346
}

2022-08-08 10:42:25,643 INFO    Thread-8  :318853 [wandb_run.py:_on_finish():1831] got exit ret: file_counts {
  wandb_count: 5
}
pusher_stats {
  uploaded_bytes: 113346
  total_bytes: 113346
}

2022-08-08 10:42:26,097 INFO    Thread-8  :318853 [wandb_run.py:_on_finish():1831] got exit ret: file_counts {
  wandb_count: 5
}
pusher_stats {
  uploaded_bytes: 113346
  total_bytes: 113346
}

2022-08-08 10:42:26,343 INFO    Thread-8  :318853 [wandb_run.py:_on_finish():1831] got exit ret: done: true
exit_result {
}
file_counts {
  wandb_count: 5
}
pusher_stats {
  uploaded_bytes: 113346
  total_bytes: 113346
}
local_info {
}

